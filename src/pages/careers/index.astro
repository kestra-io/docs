---
import Layout from "~/components/layout.astro"
import CareersHeader from "~/components/careers/Header.vue"
import CareersPositionsRenderer from "~/components/careers/PositionsRenderer.vue"
import CareersPerks from "~/components/careers/Perks.vue"
import LayoutFooterContact from "~/components/layout/FooterContact.vue"
import { $fetch } from "~/utils/fetch"
import { type Job, mapJob } from "~/utils/careers.ts"

const jobsList = await $fetch<{ results: Job[] }>(
    `https://app.dover.com/api/v1/careers-page/1fbbcad7-3e1b-4b61-96d4-f45f0b51c100/jobs?limit=300&offset=0`,
)

const positions = jobsList.results.map((job) => {
    return mapJob(job)
})

const title = "Join Us and Shape the Future of Data Orchestration"
const description =
    "Discover exciting career opportunities at Kestra. Join our passionate team and help us shape the future of data orchestration"
---

<Layout title={title} description={description}>
    <CareersHeader client:load fullPath="/careers" />
    <CareersPositionsRenderer client:visible positions={positions} />
    <CareersPerks client:visible />
    <LayoutFooterContact
        client:visible
        title="Join our community"
        darkButtonText="Join our Slack"
        darkButtonHref="/slack"
        purpleButtonText="Contribute"
        purpleButtonHref="/docs/plugin-developer-guide"
    />
</Layout>
