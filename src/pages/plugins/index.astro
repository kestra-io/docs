---
export const prerender = false;
import { getCollection } from "astro:content";
import Layout from "../../components/layout.astro";
import PluginsLists from "~/components/plugins/PluginsLists.vue";
import LayoutFooterContact from "~/components/layout/FooterContact.vue";
import type { Plugin } from "@kestra-io/ui-libs";

const pluginsData = (await getCollection('plugins')) as unknown as {data: Plugin}[]

const categoriesRes = await fetch(`https://api.kestra.io/v1/plugins/categories`);
const categoriesData = await categoriesRes.json();
---
<Layout>
    <PluginsLists
        plugins={pluginsData.map(p => p.data)}
        categories={categoriesData ?? []}
        fullPath={Astro.request.url}
        client:idle
    />
    <LayoutFooterContact
        title="Didnâ€™t find the plugin you were looking for?"
        darkButtonText="Ask on slack"
        darkButtonHref="https://kestra.io/slack"
        purpleButtonText="Create one"
        purpleButtonHref="/docs/plugin-developer-guide"
    />
</Layout>