---
import { calculateTotalPlugins } from '~/composables/usePluginsCount';
import PluginsRender from '~/components/home/PluginsRender.vue'
import { $fetchApi } from '~/utils/fetch';
const pluginLogos = await import.meta.glob('~/assets/plugins/*.svg', {eager: true}) as Record<string, any>
const pluginsSorted = Object.entries(pluginLogos).map(([name, logo]) => ({ name: name.split('/').pop()?.split('.').shift() ?? "", logo: logo.default.src as string })).sort(() => 0.5 - Math.random()).slice(0, 20);

const plugins = await $fetchApi("/plugins/subgroups")
const totalPlugins = calculateTotalPlugins(plugins);
---
<PluginsRender totalPlugins={totalPlugins} pluginLogos={pluginsSorted} />