---
title: "Orchestrate your LakeHouse with Kestra and DuckDB"
description: "DuckDB and Kestra offer a solution to reduces costs and complexities of your Lakehouse architecture "
date: 2024-03-14T14:00:00
category: Solutions
author:
  name: Benoit Pimpaud
  image: "bpimpaud"
image: /blogs/2024-02-06-gitops.png
---

**Combining Kestra and DuckDB to create a lakehouse architecture offers a modern approach to managing data by merging the strengths of data lakes and warehouses. This significantly reduces costs and complexities. This blog post explores how DuckDB's in-memory columnar database, which is optimized for processing data on a single node, integrates well with the orchestration capabilities of Kestra. It also covers the transition from traditional data storage methods to the more efficient and flexible lakehouse model, and discusses the use of DuckDB within Kestra environments through best practices for building scalable, cost-effective data ecosystems.**


## Data lake, Data warehouse or Data Lakehouse?

A data lake is a storage repository that holds a vast amount of raw data in its native format until it is needed. Meanwhile, a data warehouse is a system used for reporting and data analysis, and is considered a core component of business intelligence. Data warehouses are central repositories of integrated data from one or more disparate sources. They store current and historical data in one single place that are used for creating analytical reports for workers throughout the enterprise.

The lakehouse architecture merges the flexibility of data lakes with the structured query capabilities of data warehouses. It consists of three layers: a query engine, a transaction layer, and a storage layer. The transaction layer introduces an abstraction over raw storage, enabling direct table-like access to raw data, facilitated by the Open Table Format. This design enhances analytical and operational workflows, providing ACID transactions and efficient data management within a unified platform.

### We need a control plane

To manage various data sources, applications, and infrastructure, a robust control plane is essential. Kestra aligns with the concept of a control plane by providing a centralized, comprehensive orchestration layer for managing data workflows, infrastructure, and applications. It simplifies complex operations, enabling users to define, automate, and monitor processes across different environments. This orchestration layer acts as a control plane by offering visibility and control over various components, streamlining execution, and enhancing efficiency in data-driven ecosystems.

## Orchestrate your Lakehouse with kestra and DuckDB

In our exploration of DuckDB's integration within Kestra environments, we've identified several layers of complexity that showcase the applications of DuckDB as the query engine for lakehouse architectures. From automating basic queries to implementing advanced data management and analytics, these levels reflect the practical scenarios and solutions our user community is actively deploying:

- **Level 1:** focuses on automating queries and managing dependencies within the stack, utilizing DuckDB for query execution and an S3 bucket for storage, with Kestra orchestrating the workflow. This level does not address SQL query management, metadata management, or "big data" capabilities.

- **Level 2:** advances by incorporating SQL query management through tools like SQLMesh or DBT, still orchestrated by Kestra. It enhances the structure from Level 1 but remains limited by the absence of metadata management and "big data" support.

- **Level 3:** represents a fully-fledged lakehouse model, adding metadata management, ACID properties, and time travel features through the integration of Apache Iceberg for the transaction layer. This level maintains the advancements of Level 2 and addresses its limitations, offering a comprehensive solution for data management and analytics.

Each level progressively builds upon the last, offering more sophisticated features and capabilities, illustrating Kestra's flexibility and power in orchestrating complex data ecosystems with DuckDB as the query engine.

## BigData is Dead, Long Live BigData

This article from [MotherDuck](https://motherduck.com/blog/big-data-is-dead/) highlights a shift towards more manageable data sizes in many organizations, suggesting that large-scale distributed computing might not be necessary for all. Instead, leveraging single-node databases like DuckDB for most data scenarios—where volumes are under 10GB—offers a cost-effective, simplified approach. For tasks that demand distributed computing, tools like Databricks or BigQuery provide the necessary scale. This perspective encourages a balanced approach to data analytics, prioritizing efficiency and practicality over the pursuit of handling ever-increasing data sizes.

## Engineers Is Your First Budget Cost not Compute

the costs often lies on compute resources, yet an equally crucial aspect is the human element of development. Kestra's intuitive, declarative syntax enhances productivity, enabling teams to focus more on innovation and less on the intricacies of orchestration. This approach efficiency but also significantly reduces overall project costs by optimizing both compute and developer resources.

