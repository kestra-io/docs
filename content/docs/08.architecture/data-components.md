---
title: Data Storage in Kestra
icon: /docs/icons/architecture.svg
---

Understand where different data components ([inputs](../05.workflow-components/05.inputs.md), [outputs](../05.workflow-components/06.outputs.md), logs, and more) are stored in Kestra’s architecture.

## Overview

Kestra processes and stores a variety of data, including [flow definitions](../05.workflow-components/01.flow.md), workflow inputs, outputs, logs, execution metadata, and more. Understanding how these components are stored helps optimize performance, configure persistence, and integrate with external storage systems.

Kestra data is stored in either the [repository](./01.main-components.md#repository), such as PostgreSQL, or in [internal storage](./data-components.md#internal-storage). By default, internal storage is local, but it can be configured to use services like [AWS S3](https://aws.amazon.com/s3/) or [MinIO](https://min.io/).

:::alert{type="info"}
See [Kestra architecture](../08.architecture/03.deployment-architecture.md) and [internal storage](./data-components.md#internal-storage) for more details.
:::

## Data storage components

The table below outlines key data components, where they are stored, and their purpose.

| Data component | Storage location | Description |
| --- | --- | --- |
| **Flows & definitions** | Repository | Stores flows, tasks, and their configurations. |
| **Namespaces** | Repository | Organizes workflows and manages secrets, plugin defaults, and variables. |
| **Namespace files** | Internal storage | Stores code and configuration files in Kestra’s storage backend. |
| **Executions & metadata** | Repository | Stores execution details including status, timestamps, and metadata. |
| **Inputs** | Internal storage | Stores files provided as inputs to a flow execution. |
| **Input files** | Internal storage | Stores additional files for script or CLI tasks. |
| **Outputs** | Internal storage | Stores outputs from tasks, separate from the database. |
| **Output files** | Internal storage | Stores generated files for download and reuse in downstream tasks. |
| **Key-value pairs** | Internal storage & repository (metadata only) | KV store holds data in key-value format. Metadata is recorded in the repository. |
| **Logs & [audit logs](../07.enterprise/02.governance/06.audit-logs.md) (Enterprise Edition)** | Repository | Stores logs generated by tasks. |
| **Task state & variables** | Repository | Stores dynamic variables and task states during executions. |
| **Secrets** | Repository or external [secret manager](../07.enterprise/02.governance/secrets-manager.md) | Stores secrets internally or integrates with services like AWS Secrets Manager, Vault, or Google Secret Manager. |
| **Queues** | Repository or Kafka | Handles internal communication between Kestra components. |
| **Triggers** | Repository | Stores definitions of event-based triggers. |
| **User administration** | Repository | Stores RBAC, user management, and related metadata. |

## Internal storage

**Internal storage** is used for handling files during executions. It ensures efficient input and output management without burdening the database.

- **Purpose**: Handles inputs, outputs, temporary execution data, and artifacts such as [namespace files](../06.concepts/02.namespace-files.md).  
- **KV store**: Stores key-value pairs in internal storage, with metadata in the repository. Metadata includes the key, URI, TTL, and timestamps.  
- **Backends**: By default, Kestra uses local storage, but for production you can configure cloud storage such as:
  - [AWS S3](https://aws.amazon.com/s3/)
  - [Google Cloud Storage](https://cloud.google.com/storage)
  - [Azure Blob Storage](https://azure.microsoft.com/en-us/services/storage/blobs/)
  - [MinIO](https://min.io/)
  - Any S3-compatible service

### Configuring internal storage

Example `docker-compose.yaml` configuration for AWS S3:

```yaml
kestra:
  storage:
    type: s3
    bucket: "kestra-internal-storage"
    region: "us-east-1"
```

For full details, see [internal storage configuration](../08.architecture/data-components.md#internal-storage).

## Additional information

### Flows and execution metadata

- Stored in **PostgreSQL**, **MySQL**, or **H2** (not recommended for distributed components).  
- Includes:
  - Flow definitions  
  - Execution details  
  - Execution queues  
  - Historical metadata  
- Accessible via the [Kestra API](../api-reference/index.md) and [UI](../09.ui/index.md).

### Logs

- **Open source**: Logs are stored in the database.  
- **Enterprise Edition**: Supports Elasticsearch as a log backend, in addition to the database.  
  - Audit logs are stored in the repository.  
- Logs can be accessed through the API, UI, or external logging integrations such as the [log shipper](../07.enterprise/02.governance/logshipper.md).

### Queues

- **Open source**: Stored in the database.  
- **Enterprise Edition**: Can use Kafka for inter-component messaging.

### Secrets management

Secrets can be stored in Kestra’s database or in external managers like [AWS Secrets Manager](https://aws.amazon.com/secrets-manager/), [Google Secret Manager](https://cloud.google.com/secret-manager), [Azure Key Vault](https://azure.microsoft.com/products/key-vault/), or [HashiCorp Vault](https://developer.hashicorp.com/vault/docs/secrets/kv/kv-v2).  

Example configuration for AWS Secret Manager:

```yaml
kestra:
  secret:
    type: aws-secret-manager
    aws-secret-manager:
      access-key-id: my-access-key
      secret-key-id: my-secret-key
      sessionToken: my-session-token
      region: us-east-1
```

See [secret managers](../07.enterprise/02.governance/secrets-manager.md) for more.

### Database maintenance

Since databases accumulate large amounts of execution and log data, it’s recommended to use [purge tasks](../10.administrator-guide/purge.md) to free up storage and maintain performance.

## Conclusion

Kestra separates structured execution data from file-based artifacts to keep performance optimal:  
- **Database**: Stores flows, metadata, logs, and secrets.  
- **Internal storage**: Stores inputs, outputs, and files.  

For large-scale deployments, cloud storage backends ensure scalability.  
To further separate data across business units or environments, see the [governance features](../07.enterprise/02.governance/index.md) in the [Enterprise Edition](../07.enterprise/01.overview/01.enterprise-edition.md), including [tenants](../07.enterprise/02.governance/tenants.md).
